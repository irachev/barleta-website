<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>barleta.bg</title>

    <!-- Bootstrap core CSS -->
    <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="startbootstrap-business-casual-gh-pages/barleta555.css">
    <link rel="stylesheet" href="bootstrap/css/bootstrap-grid.css">
    <link rel="stylesheet" href="lightbox2-master/dist/css/lightbox.min.css">
    <link rel="stylesheet" href="lightbox2-master/dist/css/lightbox.css">
    <!-- Custom fonts for this template -->
    <link href="https://fonts.googleapis.com/css?family=Raleway:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i"
          rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Lora:400,400i,700,700i" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="../css/business-casual.min.css" rel="stylesheet">
    <link rel="stylesheet" href="myProjects/webProject/icofont/css/icofont.min.css">

    <script src="/path/to/cdn/jquery.min.js"></script>
    <script src="lightbox2-master/dist/js/lightbox-plus-jquery.js"></script>
    <script src="gulpfile.js"></script>
    <script src="jquery/jquery.min.js"></script>
    <script src="bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="js/barleta.js"></script>
    <link rel="stylesheet" href="icofont/icofont.css">
    <link rel="stylesheet" href="icofont/icofont.min.css">
    <link rel="stylesheet" href="startbootstrap-business-casual-gh-pages/css/business-casual.min.css">
    <link rel="stylesheet" href="startbootstrap-business-casual-gh-pages/barleta555.css">
    <script src="vendor/lightbox2-master/Gruntfile.js"></script>
    <script src="vendor/lightbox2-master/dist/js/lightbox.js"></script>
    <link rel="stylesheet" href="vendor/lightbox2-master/dist/css/lightbox.min.css">
    <script src="vendor/slick-1.8.1/slick/slick.js"></script>
    <link rel="stylesheet" href="vendor/slick-1.8.1/slick/slick.css">
    <script src=" https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">


</head>

<body>

<div class="logo-fix-text">
    <div align="center">
        <img src="images/img/logo-test.png" height="100">
    </div>
</div>

<!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-dark py-lg-4" id="mainNav">
    <div class="container">
        <!--        <a class="navbar-brand text-uppercase text-expanded font-weight-bold d-lg-none" href="#"></a>-->
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive"
                aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
            <!--<!--            display none-->
            <!--            <ul class="nav navbar-nav navbar-right"><span class="shopping-cart-text shopping-none">0</span></ul>-->
            <!--            <li class="dropdown">-->
            <!---->
            <!--                <a href="#" class="icofont-shopping-cart drop-none" data-toggle="dropdown" role="button"-->
            <!--                   aria-expanded="false"></a>-->
            <!---->
            <!---->
            <!--                <ul class="dropdown-menu dropdown-cart remove-dropdown-cart drop-cart-settings" role="menu">-->
            <!--                    <li><a href="carth.php" class="finaly-text-cart">Влезте в кошницата за-->
            <!--                            пазаруване</a></li>-->
            <!--                    <li class="remove-text" style="display: none">Количката е празна</li>-->
            <!--                </ul>-->
            <!--            </li>-->
            <!--<!--            display none-->
            <ul class="navbar-nav mx-auto">
                <li class="nav-item active px-lg-4">
                    <a class="nav-link text-uppercase text-expanded" href="index.php">Начало
                        <span class="sr-only">(current)</span>
                    </a>
                </li>
                <li class="nav-item px-lg-4">
                    <a class="nav-link text-uppercase text-expanded" href="about.php">За нас</a>
                </li>
                <li class="nav-item px-lg-4">
                    <a class="nav-link text-uppercase text-expanded" href="products.php">Видове кафета</a>
                </li>
                <li class="nav-item px-lg-4 landscape-media">
                    <div class="dropdown">
                        <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton"
                                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Био Продукти
                        </button>
                        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                            <a class="dropdown-item" href="dobavki.php">Добавки</a>
                            <a class="dropdown-item" href="babyfood.php">Бебешки храни</a>
                            <a class="dropdown-item" href="variva.php">Варива</a>
                        </div>
                    </div>
                </li>
                <li class="nav-item px-lg-4">
                    <a class="nav-link text-uppercase text-expanded" href="carth.php">Кошница</a>
                </li>
                <li class="nav-item px-lg-4">
                    <a class="nav-link text-uppercase text-expanded" href="store.php">Контакти</a>
                </li>
            </ul>
            </div>
            <ul class="nav navbar-nav navbar-right"><span class="shopping-cart-text">0</span>


                <li class="dropdown">

                    <a href="#" class="icofont-shopping-cart" data-toggle="dropdown" role="button"
                       aria-expanded="false"></a>


                    <ul class="dropdown-menu dropdown-cart remove-dropdown-cart drop-cart-settings settings-ipad"
                        role="menu">
                        <li><a href="carth.php" class="finaly-text-cart">Влезте в кошницата за
                                пазаруване</a></li>
                        <li class="remove-text" style="display: none">Количката е празна</li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>

</nav>
</body>

</html>

<script>
    $(document).ready(function () {

        let localStorageItemsCoffee = JSON.parse(localStorage.getItem("coffee"));

        let countSum = 0;


        if (JSON.parse(localStorage.getItem("coffee")).length > 0) {

            $.each(localStorageItemsCoffee, function (index, value) {

                let newName = value.name
                let newPrice = value.price
                let newImage = value.image
                let newQuantity = value.quantity

                let html = '   <li class="remove-li">\n        <img class="example-image fix-image fix-image-media import-image" src=' + newImage + ' alt="image-1" height="225" width="225"><h2 class="import-name">' + newName + '</h2><h4 class="remove-class-price">Цена: ' + newPrice + ' лв.<input type="number" class="fix-input import-kolichestvo" value=' + newQuantity + ' min="1" max="100" style="text-align: center"></h4><button class="btn btn-danger icofont-ui-close"></button> </li>\n'

                $(".dropdown-cart").append(html);


                countSum += parseFloat(newPrice) * (newQuantity)


                let image = '\n        <img class="example-image fix-image fix-image-media import-image settings-cart-image" src=' + newImage + ' alt="image-1" height="100" width="100">\n'
                let name = '\n <h2 class="import-name settings-cart-name">' + newName + '\n'
                let price = '\n <h4 class="remove-class-price settings-cart-price">Цена: <span class="get-value-td">' + newPrice + '</span> лв.\n'
                let quantity = '\n <input data-attr="1" type="number" class="fix-input import-kolichestvo settings-cart-quantity shop-cart" value=' + newQuantity + ' min="1" max="100" style="text-align: center">\n'
                let remove = '\n <button class="btn btn-danger icofont-ui-close settings-cart-button cart-remove-element local-remove-element"></button>\n'


                $('.append-tr-product').append('<tr> <td>' + image + '</td><td>' + name + '</td><td>' + price + '</td><td>' + quantity + '</td><td>' + remove + '</td></tr>')

            });

        }


        let localStorageItemsDobavki = JSON.parse(localStorage.getItem("dobavki"));


        if (JSON.parse(localStorage.getItem("dobavki")).length > 0) {

            $.each(localStorageItemsDobavki, function (index, value) {

                let newName = value.name
                let newPrice = value.price
                let newImage = value.image
                let newQuantity = value.quantity

                let html = '   <li class="remove-li">\n        <img class="example-image fix-image fix-image-media import-image" src=' + newImage + ' alt="image-1" height="225" width="225"><h2 class="import-name">' + newName + '</h2><h4 class="remove-class-price">Цена: ' + newPrice + ' лв.<input type="number" class="fix-input import-kolichestvo" value=' + newQuantity + ' min="1" max="100" style="text-align: center"></h4><button class="btn btn-danger icofont-ui-close"></button> </li>\n'

                $(".dropdown-cart").append(html);

                countSum += parseFloat(newPrice) * (newQuantity)

                let imageDobavki = '\n        <img class="example-image fix-image fix-image-media import-image settings-cart-image" src=' + newImage + ' alt="image-1" height="100" width="100">\n'
                let nameDobavki = '\n <h2 class="import-name settings-cart-name">' + newName + '\n'
                let priceDobavki = '\n <h4 class="remove-class-price settings-cart-price">Цена: <span class="get-value-td">' + newPrice + '</span>лв.\n'
                let quantityDobavki = '\n <input data-attr="1" type="number" class="fix-input import-kolichestvo settings-cart-quantity shop-cart" value=' + newQuantity + ' min="1" max="100" style="text-align: center">\n'
                let removeDobavki = '\n <button class="btn btn-danger icofont-ui-close settings-cart-button cart-remove-element local-remove-element"></button>\n'


                $('.append-tr-product').append('<tr> <td>' + imageDobavki + '</td><td>' + nameDobavki + '</td><td>' + priceDobavki + '</td><td>' + quantityDobavki + '</td><td>' + removeDobavki + '</td></tr>')


            });

        }


        let localStorageItemsBabyfood = JSON.parse(localStorage.getItem("babyfood"));

        if (JSON.parse(localStorage.getItem("babyfood")).length > 0) {

            $.each(localStorageItemsBabyfood, function (index, value) {

                let newName = value.name
                let newPrice = value.price
                let newImage = value.image
                let newQuantity = value.quantity

                let html = '   <li class="remove-li">\n        <img class="example-image fix-image fix-image-media import-image" src=' + newImage + ' alt="image-1" height="225" width="225"><h2 class="import-name">' + newName + '</h2><h4 class="remove-class-price">Цена: ' + newPrice + ' лв.<input type="number" class="fix-input import-kolichestvo" value=' + newQuantity + ' min="1" max="100" style="text-align: center"></h4><button class="btn btn-danger icofont-ui-close"></button></li>\n'

                $(".dropdown-cart").append(html);

                countSum += parseFloat(newPrice) * (newQuantity)

                let imageBabyfood = '\n        <img class="example-image fix-image fix-image-media import-image settings-cart-image" src=' + newImage + ' alt="image-1" height="100" width="100">\n'
                let nameBabyfood = '\n <h2 class="import-name settings-cart-name">' + newName + '\n'
                let priceBabyfood = '\n <h4 class="remove-class-price settings-cart-price">Цена: <span class="get-value-td">' + newPrice + '</span>лв.\n'
                let quantityBabyfood = '\n <input data-attr="1" type="number" class="fix-input import-kolichestvo settings-cart-quantity shop-cart" value=' + newQuantity + ' min="1" max="100" style="text-align: center">\n'
                let removeBabyfood = '\n <button class="btn btn-danger icofont-ui-close settings-cart-button cart-remove-element local-remove-element"></button>\n'


                $('.append-tr-product').append('<tr> <td>' + imageBabyfood + '</td><td>' + nameBabyfood + '</td><td>' + priceBabyfood + '</td><td>' + quantityBabyfood + '</td><td>' + removeBabyfood + '</td></tr>')


            });

        }


        let localStorageItemsVariva = JSON.parse(localStorage.getItem("variva"));

        if (JSON.parse(localStorage.getItem("variva")).length > 0) {

            $.each(localStorageItemsVariva, function (index, value) {

                let newName = value.name
                let newPrice = value.price
                let newImage = value.image
                let newQuantity = value.quantity

                let html = '   <li class="remove-li">\n        <img class="example-image fix-image fix-image-media import-image" src=' + newImage + ' alt="image-1" height="225" width="225"><h2 class="import-name">' + newName + '</h2><h4 class="remove-class-price">Цена: ' + newPrice + ' лв.<input type="number" class="fix-input import-kolichestvo" value=' + newQuantity + ' min="1" max="100" style="text-align: center"></h4><button class="btn btn-danger icofont-ui-close"></button> </li>\n'

                $(".dropdown-cart").append(html);

                countSum += parseFloat(newPrice) * (newQuantity)

                let imageVariva = '\n        <img class="example-image fix-image fix-image-media import-image settings-cart-image" src=' + newImage + ' alt="image-1" height="100" width="100">\n'
                let nameVariva = '\n <h2 class="import-name settings-cart-name">' + newName + '\n'
                let priceVariva = '\n <h4 class="remove-class-price settings-cart-price">Цена: <span class="get-value-td">' + newPrice + '</span>лв.\n'
                let quantityVariva = '\n <input data-attr="1" type="number" class="fix-input import-kolichestvo settings-cart-quantity shop-cart" value=' + newQuantity + ' min="1" max="100" style="text-align: center">\n'
                let removeVariva = '\n <button class="btn btn-danger icofont-ui-close settings-cart-button cart-remove-element local-remove-element"></button>\n'


                $('.append-tr-product').append('<tr> <td>' + imageVariva + '</td><td>' + nameVariva + '</td><td>' + priceVariva + '</td><td>' + quantityVariva + '</td><td>' + removeVariva + '</td></tr>')


                countProducts()
                countEmptyCart()


            });


        }


        $('.append-tr-product').append('   <tr>\n' +
            '                            <th class="2" scope="col"></th>\n' +
            '                            <th class="3" scope="col"></th>\n' +
            '                            <th class="3" scope="col">Крайна цена:</th>\n' +
            '                            <th  class="2 set-final-price end-final-price" scope="col">' + countSum.toFixed(2) + ' лв.</th>\n' +
            '                            <th class="2" scope="col"></th>\n' +
            '                        </tr>')


        countEmptyCart()

        countProducts()


        $('.cart-remove-element').on('click', function () {

            let removeProductCoffeeCart = $(this).parents('tr').find('.import-name').text();
            let convertedProductCoffeeCart = $(this).parents('tr').find('.import-name').text().replace(/\s/g, '');

            let nameProductDelete = $('.drop-cart-settings').find('.import-name');


            $.each(nameProductDelete, function (index, value) {

                let convertedValText = $(value).text().replace(/\s/g, '');

                if (convertedValText === convertedProductCoffeeCart) {


                    $(value).parents('.remove-li').remove()
                }

            })

            $(this).parents("tr").remove()

            swal("", "Продукта бе премахнат от количката", "warning")
            event.stopPropagation();
            countProducts()
            countEmptyCart()

        })


        $('.local-remove-element').on('click', function () {

            let removeProductCoffeeLocal = $(this).parents('tr').find('.import-name').text().replace(/\s/g, '');


            let arrayDeleteCoffeeLocal = []
            let StorageCoffeeLocal = JSON.parse(window.localStorage.getItem('coffee'));

            $.each(StorageCoffeeLocal, function (index, value) {
                let convertedValLocalCoffee = value.name.replace(/\s/g, '');
                if (removeProductCoffeeLocal !== convertedValLocalCoffee) {

                    arrayDeleteCoffeeLocal.push(StorageCoffeeLocal[index])


                }

                event.stopPropagation();
            })


            localStorage.setItem('coffee', JSON.stringify(arrayDeleteCoffeeLocal));


            let removeProductDobavkiLocal = $(this).parents('tr').find('.import-name').text().replace(/\s/g, '');


            let arrayDeleteDobavkiLocal = []
            let StorageDobavkiLocal = JSON.parse(window.localStorage.getItem('dobavki'));

            $.each(StorageDobavkiLocal, function (index, value) {
                let convertedValLocalDobavki = value.name.replace(/\s/g, '');
                if (removeProductDobavkiLocal !== convertedValLocalDobavki) {

                    arrayDeleteDobavkiLocal.push(StorageDobavkiLocal[index])


                }

                event.stopPropagation();
            })


            localStorage.setItem('dobavki', JSON.stringify(arrayDeleteDobavkiLocal));


            let removeProductBabyfoodLocal = $(this).parents('tr').find('.import-name').text().replace(/\s/g, '');


            let arrayDeleteBabyfoodLocal = []
            let StorageBabyfoodLocal = JSON.parse(window.localStorage.getItem('babyfood'));

            $.each(StorageBabyfoodLocal, function (index, value) {
                let convertedValLocalBabyfood = value.name.replace(/\s/g, '');
                if (removeProductBabyfoodLocal !== convertedValLocalBabyfood) {

                    arrayDeleteBabyfoodLocal.push(StorageBabyfoodLocal[index])


                }

                event.stopPropagation();
            })


            localStorage.setItem('babyfood', JSON.stringify(arrayDeleteBabyfoodLocal));


            let removeProductVarivaLocal = $(this).parents('tr').find('.import-name').text().replace(/\s/g, '');


            let arrayDeleteVarivaLocal = []
            let StorageVarivaLocal = JSON.parse(window.localStorage.getItem('variva'));

            $.each(StorageVarivaLocal, function (index, value) {
                let convertedValLocalVariva = value.name.replace(/\s/g, '');
                if (removeProductVarivaLocal !== convertedValLocalVariva) {

                    arrayDeleteVarivaLocal.push(StorageVarivaLocal[index])


                }

                event.stopPropagation();
            })


            localStorage.setItem('variva', JSON.stringify(arrayDeleteVarivaLocal));


            let currnetPrice = parseFloat($(this).parents('tr').find('.get-value-td').text());
            countSum -= currnetPrice


            $('.set-final-price').text(countSum.toFixed(2) + ' лв.');

            countEmptyCart()
        });


        $('body').on('change', '.settings-cart-quantity', function () {


            if(parseInt($(this).attr('data-attr')) < parseInt($(this).val())){

                let currnetQuantity = parseFloat($(this).parents('tr').find('.get-value-td').text());


                let settingsQuantity = $(this).val();


                let resultQuantity = $('.end-final-price').text();


                resultQuantity = parseFloat(currnetQuantity * settingsQuantity);

                countSum += parseFloat(resultQuantity - resultQuantity) + currnetQuantity;
                $('.end-final-price').text(countSum.toFixed(2) + ' лв.');

            }else{

                let currnetQuantity = parseFloat($(this).parents('tr').find('.get-value-td').text());


                let settingsQuantity = $(this).val();


                let resultQuantity = $('.end-final-price').text();


                resultQuantity = parseFloat(currnetQuantity / settingsQuantity);

                countSum += parseFloat(resultQuantity - currnetQuantity) - resultQuantity;
                $('.end-final-price').text(countSum.toFixed(2) + ' лв.');
            }


            $(this).attr('data-attr',parseInt($(this).val()))

        });


        // $('.end-final-price').attr("data-progress", 100);


        function countEmptyCart() {


            if ($('.dropdown-cart li').length - 2) {


                $('.remove-text').hide()
            }
            else {
                $('.remove-text').show()
            }
        }


        function countProducts() {

            if ($('.dropdown-cart li').length > 0) {


                let count = $('.dropdown-cart li').length - 2

                $('.shopping-cart-text').text(count)

                $('.shopping-cart-text').text().length;

            }

        }


        countProducts()

        countEmptyCart()


        setTimeout(function () {
            countProducts()
        }, 1500);
        setTimeout(function () {
            countEmptyCart()
        }, 1500);


        $('.and-order-text').on('click', function () {



            localStorage.setItem('finalPrice', JSON.stringify(parseFloat($('.end-final-price').text())));

            localStorage.setItem('finalName', JSON.stringify($('.settings-cart-name').text()));


            // $.each(settings-cart-quantity, function (index, value) {
            //     localStorage.setItem('finalQuantity', JSON.stringify(parseInt($('.settings-cart-quantity').val())));
            //
            // })
            // localStorage.setItem('finalQuantity', JSON.stringify(parseInt($('.settings-cart-quantity').val())));
        });

    })
</script>



